extends ./layout

block task-content
    div(ng-controller="CreateUpdateTaskCtrl", ng-init="init('#{id}')")
        form(role="form", ng-submit="submit()")
            .form-group
                label(for="name") Task Name:
                    span.required  *
                input.form-control(ng-model="task.name", placeholder="Task Name", required="required")
            .form-group
                label(for="description") Task Description:
                    span.required  *
                input.form-control(ng-model="task.description", placeholder="Task Description", required="required")
            .form-group
                .row
                    .col-md-3
                        label(for="external_id") Feature TFS ID:
                            span.required  *
                        input.form-control(ng-model="task.external_id", placeholder="12345", required="required")
                    .col-md-9
                        label(for="availability") Availability:
                        .row
                            .col-md-12
                                .radio
                                    label
                                        input(type="radio", name="availability", value="0", ng-model="task.availability.availability_type")
                                        | General Availability
                        .row
                            .col-md-3
                                .radio
                                    label
                                        input(type="radio", name="availability", value="1", ng-model="task.availability.availability_type")
                                        | Partner Specific
                            .col-md-9
                                input(type="hidden", ui-select2="ui.availability.partners.select", ng-model="task.availability.partners", placeholder="Partners", ng-disabled="task.availability.availability_type == 0")
            br
            .form-group
                label Input:
                    span.required  *
                table.table.table-striped(style="margin-bottom: 0px")
                    thead
                        th Condition
                        th Enter from UI
                        th Enter via API
                        th Generated by Task
                        th
                    tbody
                        tr(ng-repeat="condition in task.input.conditions")
                            td
                                include partial_condition_icon
                                |  
                                a(href="#", ng-click="task.input.createUpdateCondition(condition)") {{condition.name}}
                            td
                                | {{condition.ui.input}}
                            td
                                | {{condition.api.input}}
                            td
                            td.col-td-min
                                a(href="#", ng-click="task.removeCondition(task.input.conditions, condition)")
                                    span.glyphicon.glyphicon-remove
            .form-group
                .row
                    .col-md-3
                        input#input-add-condition.form-control(ng-model="task.input.findConditionCriteria", typeahead="condition as condition.name for condition in task.findCondition($viewValue)", typeahead-on-select="task.input.pushCondition($item)", placeholder="Search for condition")
                    .col-md-9
            .form-group
                span.glyphicon.glyphicon-plus
                |  
                a(href="#" ng-click="task.input.createUpdateCondition()") Add one more Input
            br
            .form-group
                label Output:
                    span.required  *
                table.table.table-striped
                    thead
                        th Condition
                        th Affects Task
                        th Affect Description
                        th Displayed on UI
                        th Used in API
                        th Used as Input for Task
                        th
                    tbody
                        tr(ng-repeat="condition in task.output.conditions")
                            td
                                include partial_condition_icon
                                |  
                                a(href="#", ng-click="task.output.createUpdateCondition(condition)") {{condition.name}}
                            td
                            td
                            td
                                | {{condition.ui.output}}
                            td
                                | {{condition.api.output}}
                            td
                            td.col-td-min
                                a(href="#", ng-click="task.removeCondition(task.output.conditions, condition)")
                                    span.glyphicon.glyphicon-remove
            .form-group
                .row
                    .col-md-3
                        input#input-add-condition.form-control(ng-model="task.output.findConditionCriteria", typeahead="condition as condition.name for condition in task.findCondition($viewValue)", typeahead-on-select="task.output.pushCondition($item)", placeholder="Search for condition")
                    .col-md-9
            .form-group
                span.glyphicon.glyphicon-plus
                |  
                a(href="#" ng-click="task.output.createUpdateCondition()") Add one more Output
            br
            input(type="submit", value="Submit").btn.btn-primary
            a.btn.btn-default(type="button", href="/") Cancel